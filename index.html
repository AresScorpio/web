<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Concourse</title>
    <link href="{{asset "main.css"}}" media="all" rel="stylesheet" type="text/css" />
    <link id="favicon" rel="icon" type="image/png" href="{{asset "images/favicon.png"}}" />
    <meta name="theme-color" content="#000000" />
    <script src="{{asset "index.js"}}"></script>
    <script src="{{asset "d3.v355.min.js"}}"></script>
    <script src="{{asset "graph.js"}}"></script>
    <script src="{{asset "jquery-2.1.1.min.js"}}"></script>
    <script src="{{asset "concourse.js"}}"></script>
    <script src="{{asset "elm.min.js"}}"></script>
  </head>
  <body>
    <div id="elm-app-embed"></div>

    <script type="text/javascript">
      var node = document.getElementById("elm-app-embed");
      var app = Elm.Main.embed(node, {
        turbulenceImgSrc: {{asset "images/buckleup.svg"}}
      });

      app.ports.renderPipeline.subscribe(function (values) {
        foundSvg = d3.select(".pipeline-graph");
        var svg = createPipelineSvg(foundSvg)
        if (svg.node() != null) {
          var jobs = values[0];
          var resources = values[1];
          draw(svg, jobs, resources);
        }
      })

      app.ports.setTitle.subscribe(function(title) {
        document.title = title + "Concourse";
      });

    </script>
  </body>
</html>

<!-- <script type="text/javascript">


topBar.ports.groupsChanged.subscribe(function(groups) {
  var changed = false;

  for (var groupName in concourse.groups) {
    if (groups.indexOf(groupName) === -1) {
      changed = true;
      delete concourse.groups[groupName];
    }
  }

  for (var i in groups) {
    if (!concourse.groups[groups[i]]) {
      changed = true;
      concourse.groups[groups[i]] = true;
    }
  }

  if (changed && concourse.redraw !== undefined) {
    concourse.redraw();
  }
});

topBar.ports.setViewingPipeline.send(true);

</script> -->
