{{define "title"}}{{.Job.Name}} #{{.Build.Name}} - Concourse{{end}}

{{define "body"}}
<div id="page-header" class="{{.Build.Status}}">
  <div class="build-header">
    <form class="trigger-build" method="post" action="{{url "TriggerBuild" .Job}}">
      <input type="submit" value="trigger build" />
    </form>

    {{if .Abortable}}
    <form class="abort-build" method="post" action="{{url "AbortBuild" .Build}}">
      <input type="submit" value="abort" />
    </form>
    {{end}}

    <a class="back" href="/">&larr;</a>

    <h1>{{.Job.Name}} #{{.Build.Name}}</h1>

    <dl class="build-times"></dl>
  </div>

  <ul id="builds">
    {{$job := .Job}}
    {{$currentName := .Build.Name}}
    {{/* omitting whitespace for display-block style */}}
    {{range .Builds}}<li class="{{.Status}}{{if eq .Name $currentName}} current{{end}}"><a href="{{url "GetBuild" $job .}}">{{.Name}}</a></li>{{end}}
  </ul>
</div>

<div id="build-body"></div>

<script src="{{url "Public" "build.js"}}"></script>
<script type="text/javascript">
  var inputResources = [
  {{range .Inputs}}
    {
      resource: "{{.Name}}",
      first_occurence: {{.FirstOccurrence}},
      version: {
      {{range $name, $val := .Version}}
        "{{$name}}": "{{$val}}",
      {{end}}
      },
      metadata: [
      {{range .Metadata}}
        { name: "{{.Name}}", value: "{{.Value}}" },
      {{end}}
      ],
    },
  {{end}}
  ];

  for (var i = 0; i < inputResources.length; i++) {
    renderResource({ input: inputResources[i] }, "input");
  }
  streamLog({{url "LogOutput" .Build | js}})
</script>
{{end}}
