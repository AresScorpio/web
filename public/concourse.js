!function(e){"use strict";"function"==typeof define&&define.amd?define(e):"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=e():"undefined"!=typeof Package?Sortable=e():window.Sortable=e()}(function(){"use strict";function e(e,t){this.el=e,this.options=t=v({},t),e[U]=this;var i={group:Math.random(),sort:!0,disabled:!1,store:null,handle:null,scroll:!0,scrollSensitivity:30,scrollSpeed:10,draggable:/[uo]l/i.test(e.nodeName)?"li":">*",ghostClass:"sortable-ghost",ignore:"a, img",filter:null,animation:0,setData:function(e,t){e.setData("Text",t.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0};for(var o in i)!(o in t)&&(t[o]=i[o]);var s=t.group;s&&"object"==typeof s||(s=t.group={name:s}),["pull","put"].forEach(function(e){e in s||(s[e]=!0)}),t.groups=" "+s.name+(s.put.join?" "+s.put.join(" "):"")+" ";for(var r in this)"_"===r.charAt(0)&&(this[r]=n(this,this[r]));a(e,"mousedown",this._onTapStart),a(e,"touchstart",this._onTapStart),a(e,"dragover",this),a(e,"dragenter",this),L.push(this._onDragOver),t.store&&this.sort(t.store.get(this))}function t(e){y&&y.state!==e&&(l(y,"display",e?"none":""),!e&&y.state&&C.insertBefore(y,m),y.state=e)}function n(e,t){var n=M.call(arguments,2);return t.bind?t.bind.apply(t,[e].concat(n)):function(){return t.apply(e,n.concat(M.call(arguments)))}}function i(e,t,n){if(e){n=n||A,t=t.split(".");var i=t.shift().toUpperCase(),o=new RegExp("\\s("+t.join("|")+")\\s","g");do if(">*"===i&&e.parentNode===n||(""===i||e.nodeName.toUpperCase()==i)&&(!t.length||((" "+e.className+" ").match(o)||[]).length==t.length))return e;while(e!==n&&(e=e.parentNode))}return null}function o(e){e.dataTransfer.dropEffect="move",e.preventDefault()}function a(e,t,n){e.addEventListener(t,n,!1)}function s(e,t,n){e.removeEventListener(t,n,!1)}function r(e,t,n){if(e)if(e.classList)e.classList[n?"add":"remove"](t);else{var i=(" "+e.className+" ").replace(P," ").replace(" "+t+" "," ");e.className=(i+(n?" "+t:"")).replace(P," ")}}function l(e,t,n){var i=e&&e.style;if(i){if(void 0===n)return A.defaultView&&A.defaultView.getComputedStyle?n=A.defaultView.getComputedStyle(e,""):e.currentStyle&&(n=e.currentStyle),void 0===t?n:n[t];t in i||(t="-webkit-"+t),i[t]=n+("string"==typeof n?"":"px")}}function u(e,t,n){if(e){var i=e.getElementsByTagName(t),o=0,a=i.length;if(n)for(;a>o;o++)n(i[o],o);return i}return[]}function d(e){e.draggable=!1}function c(){Y=!1}function p(e,t){var n=e.lastElementChild,i=n.getBoundingClientRect();return t.clientY-(i.top+i.height)>5&&n}function f(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,n=t.length,i=0;n--;)i+=t.charCodeAt(n);return i.toString(36)}function h(e){for(var t=0;e&&(e=e.previousElementSibling);)"TEMPLATE"!==e.nodeName.toUpperCase()&&t++;return t}function g(e,t){var n,i;return function(){void 0===n&&(n=arguments,i=this,setTimeout(function(){1===n.length?e.call(i,n[0]):e.apply(i,n),n=void 0},t))}}function v(e,t){if(e&&t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}var m,b,y,C,_,D,$,E,S,w,T,N,x,j,B={},P=/\s+/g,U="Sortable"+(new Date).getTime(),k=window,A=k.document,I=k.parseInt,O=!!("draggable"in A.createElement("div")),Y=!1,R=function(e,t,n,i,o,a,s){var r=A.createEvent("Event"),l=(e||t[U]).options,u="on"+n.charAt(0).toUpperCase()+n.substr(1);r.initEvent(n,!0,!0),r.item=i||t,r.from=o||t,r.clone=y,r.oldIndex=a,r.newIndex=s,l[u]&&l[u].call(e,r),t.dispatchEvent(r)},X=Math.abs,M=[].slice,L=[],H=g(function(e,t,n){if(n&&t.scroll){var i,o,a,s,r=t.scrollSensitivity,l=t.scrollSpeed,u=e.clientX,d=e.clientY,c=window.innerWidth,p=window.innerHeight;if($!==n&&(D=t.scroll,$=n,D===!0)){D=n;do if(D.offsetWidth<D.scrollWidth||D.offsetHeight<D.scrollHeight)break;while(D=D.parentNode)}D&&(i=D,o=D.getBoundingClientRect(),a=(X(o.right-u)<=r)-(X(o.left-u)<=r),s=(X(o.bottom-d)<=r)-(X(o.top-d)<=r)),a||s||(a=(r>=c-u)-(r>=u),s=(r>=p-d)-(r>=d),(a||s)&&(i=k)),(B.vx!==a||B.vy!==s||B.el!==i)&&(B.el=i,B.vx=a,B.vy=s,clearInterval(B.pid),i&&(B.pid=setInterval(function(){i===k?k.scrollTo(k.pageXOffset+a*l,k.pageYOffset+s*l):(s&&(i.scrollTop+=s*l),a&&(i.scrollLeft+=a*l))},24)))}},30);return e.prototype={constructor:e,_onTapStart:function(e){var t=this,n=this.el,o=this.options,a=e.type,s=e.touches&&e.touches[0],r=(s||e).target,l=r,u=o.filter;if(!("mousedown"===a&&0!==e.button||o.disabled)&&(r=i(r,o.draggable,n))){if(w=h(r),"function"==typeof u){if(u.call(this,e,r,this))return R(t,l,"filter",r,n,w),void e.preventDefault()}else if(u&&(u=u.split(",").some(function(e){return e=i(l,e.trim(),n),e?(R(t,e,"filter",r,n,w),!0):void 0})))return void e.preventDefault();(!o.handle||i(l,o.handle,n))&&this._prepareDragStart(e,s,r)}},_prepareDragStart:function(e,t,n){var i,o=this,s=o.el,r=o.options,l=s.ownerDocument;n&&!m&&n.parentNode===s&&(x=e,C=s,m=n,_=m.nextSibling,N=r.group,i=function(){o._disableDelayedDrag(),m.draggable=!0,r.ignore.split(",").forEach(function(e){u(m,e.trim(),d)}),o._triggerDragStart(t)},a(l,"mouseup",o._onDrop),a(l,"touchend",o._onDrop),a(l,"touchcancel",o._onDrop),r.delay?(a(l,"mousemove",o._disableDelayedDrag),a(l,"touchmove",o._disableDelayedDrag),o._dragStartTimer=setTimeout(i,r.delay)):i())},_disableDelayedDrag:function(){var e=this.el.ownerDocument;clearTimeout(this._dragStartTimer),s(e,"mousemove",this._disableDelayedDrag),s(e,"touchmove",this._disableDelayedDrag)},_triggerDragStart:function(e){e?(x={target:m,clientX:e.clientX,clientY:e.clientY},this._onDragStart(x,"touch")):O?(a(m,"dragend",this),a(C,"dragstart",this._onDragStart)):this._onDragStart(x,!0);try{A.selection?A.selection.empty():window.getSelection().removeAllRanges()}catch(t){}},_dragStarted:function(){C&&m&&(r(m,this.options.ghostClass,!0),e.active=this,R(this,C,"start",m,C,w))},_emulateDragOver:function(){if(j){l(b,"display","none");var e=A.elementFromPoint(j.clientX,j.clientY),t=e,n=" "+this.options.group.name,i=L.length;if(t)do{if(t[U]&&t[U].options.groups.indexOf(n)>-1){for(;i--;)L[i]({clientX:j.clientX,clientY:j.clientY,target:e,rootEl:t});break}e=t}while(t=t.parentNode);l(b,"display","")}},_onTouchMove:function(e){if(x){var t=e.touches?e.touches[0]:e,n=t.clientX-x.clientX,i=t.clientY-x.clientY,o=e.touches?"translate3d("+n+"px,"+i+"px,0)":"translate("+n+"px,"+i+"px)";j=t,l(b,"webkitTransform",o),l(b,"mozTransform",o),l(b,"msTransform",o),l(b,"transform",o),e.preventDefault()}},_onDragStart:function(e,t){var n=e.dataTransfer,i=this.options;if(this._offUpEvents(),"clone"==N.pull&&(y=m.cloneNode(!0),l(y,"display","none"),C.insertBefore(y,m)),t){var o,s=m.getBoundingClientRect(),r=l(m);b=m.cloneNode(!0),l(b,"top",s.top-I(r.marginTop,10)),l(b,"left",s.left-I(r.marginLeft,10)),l(b,"width",s.width),l(b,"height",s.height),l(b,"opacity","0.8"),l(b,"position","fixed"),l(b,"zIndex","100000"),C.appendChild(b),o=b.getBoundingClientRect(),l(b,"width",2*s.width-o.width),l(b,"height",2*s.height-o.height),"touch"===t?(a(A,"touchmove",this._onTouchMove),a(A,"touchend",this._onDrop),a(A,"touchcancel",this._onDrop)):(a(A,"mousemove",this._onTouchMove),a(A,"mouseup",this._onDrop)),this._loopId=setInterval(this._emulateDragOver,150)}else n&&(n.effectAllowed="move",i.setData&&i.setData.call(this,n,m)),a(A,"drop",this);setTimeout(this._dragStarted,0)},_onDragOver:function(e){var n,o,a,s=this.el,r=this.options,u=r.group,d=u.put,f=N===u,h=r.sort;if(void 0!==e.preventDefault&&(e.preventDefault(),!r.dragoverBubble&&e.stopPropagation()),N&&!r.disabled&&(f?h||(a=!C.contains(m)):N.pull&&d&&(N.name===u.name||d.indexOf&&~d.indexOf(N.name)))&&(void 0===e.rootEl||e.rootEl===this.el)){if(H(e,r,this.el),Y)return;if(n=i(e.target,r.draggable,s),o=m.getBoundingClientRect(),a)return t(!0),void(y||_?C.insertBefore(m,y||_):h||C.appendChild(m));if(0===s.children.length||s.children[0]===b||s===e.target&&(n=p(s,e))){if(n){if(n.animated)return;v=n.getBoundingClientRect()}t(f),s.appendChild(m),this._animate(o,m),n&&this._animate(v,n)}else if(n&&!n.animated&&n!==m&&void 0!==n.parentNode[U]){E!==n&&(E=n,S=l(n));var g,v=n.getBoundingClientRect(),D=v.right-v.left,$=v.bottom-v.top,w=/left|right|inline/.test(S.cssFloat+S.display),T=n.offsetWidth>m.offsetWidth,x=n.offsetHeight>m.offsetHeight,j=(w?(e.clientX-v.left)/D:(e.clientY-v.top)/$)>.5,B=n.nextElementSibling;Y=!0,setTimeout(c,30),t(f),g=w?n.previousElementSibling===m&&!T||j&&T:B!==m&&!x||j&&x,g&&!B?s.appendChild(m):n.parentNode.insertBefore(m,g?B:n),this._animate(o,m),this._animate(v,n)}}},_animate:function(e,t){var n=this.options.animation;if(n){var i=t.getBoundingClientRect();l(t,"transition","none"),l(t,"transform","translate3d("+(e.left-i.left)+"px,"+(e.top-i.top)+"px,0)"),t.offsetWidth,l(t,"transition","all "+n+"ms"),l(t,"transform","translate3d(0,0,0)"),clearTimeout(t.animated),t.animated=setTimeout(function(){l(t,"transition",""),l(t,"transform",""),t.animated=!1},n)}},_offUpEvents:function(){var e=this.el.ownerDocument;s(A,"touchmove",this._onTouchMove),s(e,"mouseup",this._onDrop),s(e,"touchend",this._onDrop),s(e,"touchcancel",this._onDrop)},_onDrop:function(t){var n=this.el,i=this.options;clearInterval(this._loopId),clearInterval(B.pid),clearTimeout(this.dragStartTimer),s(A,"drop",this),s(A,"mousemove",this._onTouchMove),s(n,"dragstart",this._onDragStart),this._offUpEvents(),t&&(t.preventDefault(),!i.dropBubble&&t.stopPropagation(),b&&b.parentNode.removeChild(b),m&&(s(m,"dragend",this),d(m),r(m,this.options.ghostClass,!1),C!==m.parentNode?(T=h(m),R(null,m.parentNode,"sort",m,C,w,T),R(this,C,"sort",m,C,w,T),R(null,m.parentNode,"add",m,C,w,T),R(this,C,"remove",m,C,w,T)):(y&&y.parentNode.removeChild(y),m.nextSibling!==_&&(T=h(m),R(this,C,"update",m,C,w,T),R(this,C,"sort",m,C,w,T))),e.active&&R(this,C,"end",m,C,w,T)),C=m=b=_=y=D=$=x=j=E=S=N=e.active=null,this.save())},handleEvent:function(e){var t=e.type;"dragover"===t||"dragenter"===t?m&&(this._onDragOver(e),o(e)):("drop"===t||"dragend"===t)&&this._onDrop(e)},toArray:function(){for(var e,t=[],n=this.el.children,o=0,a=n.length,s=this.options;a>o;o++)e=n[o],i(e,s.draggable,this.el)&&t.push(e.getAttribute(s.dataIdAttr)||f(e));return t},sort:function(e){var t={},n=this.el;this.toArray().forEach(function(e,o){var a=n.children[o];i(a,this.options.draggable,n)&&(t[e]=a)},this),e.forEach(function(e){t[e]&&(n.removeChild(t[e]),n.appendChild(t[e]))})},save:function(){var e=this.options.store;e&&e.set(this)},closest:function(e,t){return i(e,t||this.options.draggable,this.el)},option:function(e,t){var n=this.options;return void 0===t?n[e]:void(n[e]=t)},destroy:function(){var e=this.el;e[U]=null,s(e,"mousedown",this._onTapStart),s(e,"touchstart",this._onTapStart),s(e,"dragover",this),s(e,"dragenter",this),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(e){e.removeAttribute("draggable")}),L.splice(L.indexOf(this._onDragOver),1),this._onDrop(),this.el=e=null}},e.utils={on:a,off:s,css:l,find:u,bind:n,is:function(e,t){return!!i(e,t,e)},extend:v,throttle:g,closest:i,toggleClass:r,index:h},e.version="1.2.0",e.create=function(t,n){return new e(t,n)},e});var concourse={};$(".js-expandable").on("click",function(){$(this).parent().hasClass("expanded")?$(this).parent().removeClass("expanded"):$(this).parent().addClass("expanded")}),concourse.Build=function(e){this.$el=e,this.$abortBtn=this.$el.find(".js-abortBuild"),this.buildID=this.$el.data("build-id"),this.abortEndpoint="/api/v1/builds/"+this.buildID+"/abort"},concourse.Build.prototype.bindEvents=function(){var e=this;this.$abortBtn.on("click",function(t){e.abort()})},concourse.Build.prototype.abort=function(){var e=this;$.ajax({method:"POST",url:e.abortEndpoint}).done(function(t,n){e.$abortBtn.remove()}).error(function(t){e.$abortBtn.addClass("errored")})},$(function(){if($(".js-build").length){var e=new concourse.Build($(".js-build"));e.bindEvents()}}),$(function(){if($(".js-job").length){var e=new concourse.PauseUnpause($(".js-job"));e.bindEvents()}}),concourse.PauseUnpause=function(e,t,n){this.$el=e,this.pauseCallback=void 0===t?function(){}:t,this.unpauseCallback=void 0===n?function(){}:n,this.pauseBtn=this.$el.find(".js-pauseUnpause").pausePlayBtn(),this.pauseEndpoint="/api/v1/"+this.$el.data("endpoint")+"/pause",this.unPauseEndpoint="/api/v1/"+this.$el.data("endpoint")+"/unpause"},concourse.PauseUnpause.prototype.bindEvents=function(){var e=this;e.$el.delegate(".js-pauseUnpause.disabled","click",function(t){e.pause()}),e.$el.delegate(".js-pauseUnpause.enabled","click",function(t){e.unpause()})},concourse.PauseUnpause.prototype.pause=function(e){var t=this;t.pauseBtn.loading(),$.ajax({method:"PUT",url:t.pauseEndpoint}).done(function(e,n){t.pauseBtn.enable(),t.pauseCallback()}).error(function(e){t.pauseBtn.error()})},concourse.PauseUnpause.prototype.unpause=function(e){var t=this;t.pauseBtn.loading(),$.ajax({method:"PUT",url:this.unPauseEndpoint}).done(function(e){t.pauseBtn.disable(),t.unpauseCallback()}).error(function(e){t.pauseBtn.error()})},function(e){concourse.PipelinesNav=function(e){this.$el=$(e),this.$toggle=e.find($(".js-pipelinesNav-toggle")),this.$list=e.find($(".js-pipelinesNav-list")),this.pipelinesEndpoint="/api/v1/pipelines"},concourse.PipelinesNav.prototype.bindEvents=function(){var t=this;t.$toggle.on("click",function(){t.toggle()}),e.create(t.$list[0],{onUpdate:function(){t.onSort()}}),t.loadPipelines()},concourse.PipelinesNav.prototype.onSort=function(){var e=this,t=e.$list.find("a").toArray().map(function(e){return e.innerHTML});$.ajax({method:"PUT",url:e.pipelinesEndpoint+"/ordering",contentType:"application/json",data:JSON.stringify(t)})},concourse.PipelinesNav.prototype.toggle=function(){$("body").toggleClass("pipelinesNav-visible")},concourse.PipelinesNav.prototype.loadPipelines=function(){var e=this;$.ajax({method:"GET",url:e.pipelinesEndpoint}).done(function(t,n){$(t).each(function(t,n){var i=$("<li>"),o=n.paused?"enabled":"disabled",a=n.paused?"play":"pause";i.html('<span class="btn-pause fl '+o+' js-pauseUnpause"><i class="fa fa-fw fa-'+a+'"></i></span><a href="'+n.url+'">'+n.name+"</a>"),i.data("endpoint","pipelines/"+n.name),i.data("pipelineName",n.name),i.addClass("clearfix"),e.$list.append(i),e.newPauseUnpause(i),concourse.pipelineName===n.name&&n.paused&&e.$el.find(".js-groups").addClass("paused")})})},concourse.PipelinesNav.prototype.newPauseUnpause=function(e){var t=this,n=new concourse.PauseUnpause(e,function(){e.data("pipelineName")===concourse.pipelineName&&t.$el.find(".js-groups").addClass("paused")},function(){e.data("pipelineName")===concourse.pipelineName&&t.$el.find(".js-groups").removeClass("paused")});n.bindEvents()}}(Sortable),$(function(){if($(".js-pipelinesNav").length){var e=new concourse.PipelinesNav($(".js-pipelinesNav"));e.bindEvents()}}),$(function(){if($(".js-resource").length){var e=new concourse.PauseUnpause($(".js-resource"),function(){$(".js-resource").find(".js-resourceStatusText").html("checking paused")},function(){$(".js-resource").find(".js-resourceStatusText").html("checking successfully")});e.bindEvents()}}),function(e){e.fn.pausePlayBtn=function(){var t=e(this);return{loading:function(){t.removeClass("disabled enabled").addClass("loading"),t.find("i").removeClass("fa-pause").addClass("fa-circle-o-notch fa-spin")},enable:function(){t.removeClass("loading").addClass("enabled"),t.find("i").removeClass("fa-circle-o-notch fa-spin").addClass("fa-play")},error:function(){t.removeClass("loading").addClass("errored"),t.find("i").removeClass("fa-circle-o-notch fa-spin").addClass("fa-pause")},disable:function(){t.removeClass("loading").addClass("disabled"),t.find("i").removeClass("fa-circle-o-notch fa-spin").addClass("fa-pause")}}}}(jQuery);